{"state":{"threejs_example_force_local/389d9lz/65wrg0t":"noise","threejs_example_force_local/a90z9nv/gvk9hec":0.23,"threejs_example_force_local/irpi2by/gvk9hec":0.71,"threejs_example_force_local/owk1ctx/gvk9hec":8.99,"threejs_example_force_local_nonworker/9xtxdyi/gvk9hec":0.18,"threejs_example_force_local_nonworker/bc8njc4/gvk9hec":5.95,"threejs_example_force_local_nonworker/mrke1km/gvk9hec":3.57,"threejs_example_force_local_nonworker/yx1r0np/gvk9hec":7.81},"graphs":[{"description":"Use a background worker to run the runnable. The canvas will no longer be usable from the main thread.","edges":{"cmxhqcs":{"as":"args","from":"cmxhqcs","to":"2gl9npa"},"lv74cei":{"as":"value","from":"lv74cei","to":"2gl9npa"},"0au2hd5":{"as":"transferableObjects","from":"0au2hd5","to":"lv74cei"},"lhclyrg":{"as":"args","from":"lhclyrg","to":"lv74cei"},"yc7v57r":{"as":"runnable","from":"yc7v57r","to":"lv74cei"},"53ej613":{"as":"canvas","from":"53ej613","to":"lhclyrg"},"75km164":{"as":"graphid","from":"75km164","to":"lhclyrg"},"cec9g58":{"as":"transferableObjects","from":"cec9g58","to":"lhclyrg"},"ey9ce46":{"as":"args","from":"ey9ce46","to":"lhclyrg"},"b2kqy36":{"as":"canvas","from":"b2kqy36","to":"0au2hd5"},"dhxy90g":{"as":"arr","from":"dhxy90g","to":"0au2hd5"},"5ja4te3":{"as":"canvas","from":"5ja4te3","to":"cmxhqcs"},"delnny8":{"as":"_canvas","from":"delnny8","to":"cmxhqcs"},"d23z0nj":{"as":"canvas","from":"d23z0nj","to":"delnny8"}},"id":"@three.worker","name":"@three.worker","nodes":{"2gl9npa":{"id":"2gl9npa","name":"@three.worker","ref":"return"},"lv74cei":{"id":"lv74cei","ref":"extern","value":"workerPostMessage"},"yc7v57r":{"id":"yc7v57r","ref":"arg","value":"runnable"},"lhclyrg":{"id":"lhclyrg","ref":"@js.script","value":"return {\n  graphid,\n  canvas,\n  transferableObjects: transferableObjects ?? [],\n  ...(args ?? {})\n}"},"ey9ce46":{"id":"ey9ce46","ref":"arg","value":"args"},"cec9g58":{"id":"cec9g58","ref":"arg","value":"transferableObjects"},"75km164":{"id":"75km164","ref":"arg","value":"graphid"},"53ej613":{"id":"53ej613","ref":"arg","value":"_canvas"},"0au2hd5":{"id":"0au2hd5","ref":"@js.script","value":"console.log(\"transfer\", canvas, arr);\nreturn (arr ?? []).concat(canvas?.width > 0 ? [canvas] : []);"},"dhxy90g":{"id":"dhxy90g","ref":"arg","value":"arr"},"b2kqy36":{"id":"b2kqy36","ref":"arg","value":"_canvas"},"cmxhqcs":{"id":"cmxhqcs"},"delnny8":{"id":"delnny8","ref":"@js.script","value":"return canvas;\ndebugger;\nreturn canvas.width > 0 ? canvas.transferControlToOffscreen() : {};"},"d23z0nj":{"id":"d23z0nj","ref":"arg","value":"canvas"},"5ja4te3":{"id":"5ja4te3"}},"out":"2gl9npa"},{"edges":{"4n3yk4e":{"as":"value","from":"4n3yk4e","to":"tkxqh5a"},"zlyzyjv":{"as":"args","from":"zlyzyjv","to":"tkxqh5a"},"a23wspb":{"as":"parent","from":"a23wspb","to":"4n3yk4e"},"twtvjxk":{"as":"argobjnames","from":"twtvjxk","to":"4n3yk4e"},"brxx2zn":{"as":"args","from":"brxx2zn","to":"twtvjxk"},"pnszphc":{"as":"value","from":"pnszphc","to":"twtvjxk"},"1kzsgi4":{"as":"array","from":"1kzsgi4","to":"pnszphc"},"grsb8qa":{"as":"fn","from":"grsb8qa","to":"pnszphc"},"49o12hh":{"as":"fn","from":"49o12hh","to":"grsb8qa"},"5ljysw7":{"as":"parameters","from":"5ljysw7","to":"grsb8qa"},"0zs05z2":{"as":"element","from":"0zs05z2","to":"5ljysw7"},"ad6qpuc":{"as":"parent","from":"ad6qpuc","to":"49o12hh"},"b3j4v9i":{"as":"obj","from":"b3j4v9i","to":"49o12hh"},"qjadhr5":{"as":"children","from":"qjadhr5","to":"1kzsgi4"},"man8k6c":{"as":"_parent","from":"man8k6c","to":"brxx2zn"}},"id":"@three.update_children","name":"@three.update_children","nodes":{"tkxqh5a":{"id":"tkxqh5a","name":"@three.update_children","ref":"return"},"zlyzyjv":{"id":"zlyzyjv"},"4n3yk4e":{"id":"4n3yk4e","ref":"@js.script","value":"parent.children.forEach(c => {\n  if(!argobjnames.includes(c.name)){\n    console.log(\"removing\", c)\n    parent.remove(c);\n  }\n})\n\nreturn parent;"},"twtvjxk":{"id":"twtvjxk","ref":"return"},"pnszphc":{"id":"pnszphc","ref":"@data.map"},"grsb8qa":{"id":"grsb8qa","ref":"@flow.runnable"},"5ljysw7":{"id":"5ljysw7"},"0zs05z2":{"id":"0zs05z2"},"49o12hh":{"id":"49o12hh","name":"","ref":"@js.script","value":"const existingObj = parent.getObjectByName(obj.name);\nif(obj && existingObj !== obj){\n  if(existingObj) {\n    parent.remove(existingObj);\n    existingObj.geometry?.dispose();\n    existingObj.material?.dispose();\n  }\n  console.log(\"adding\", obj)\n  parent.add(obj); \n}\nreturn obj.name;"},"b3j4v9i":{"id":"b3j4v9i","ref":"arg","value":"element"},"ad6qpuc":{"id":"ad6qpuc","ref":"arg","value":"_parent"},"1kzsgi4":{"id":"1kzsgi4","ref":"@js.script","value":"return children.flat()"},"qjadhr5":{"id":"qjadhr5","ref":"arg","value":"children"},"brxx2zn":{"id":"brxx2zn"},"man8k6c":{"id":"man8k6c","ref":"arg","value":"parent"},"a23wspb":{"id":"a23wspb","ref":"arg","value":"parent"}},"out":"tkxqh5a"},{"edges":{"lihjkfp":{"as":"value","from":"lihjkfp","to":"main/out"},"x4zdk2w":{"as":"true","from":"x4zdk2w","to":"lihjkfp"},"xsjuu4i":{"as":"pred","from":"xsjuu4i","to":"lihjkfp"},"eyftv46":{"as":"canvas","from":"eyftv46","to":"xsjuu4i"},"cwl59lh":{"as":"canvas","from":"cwl59lh","to":"x4zdk2w"}},"id":"@three.renderer","nodes":{"main/out":{"__isnodysseus":true,"id":"main/out","name":"@three.renderer","ref":"return"},"lihjkfp":{"id":"lihjkfp","ref":"@flow.if"},"xsjuu4i":{"id":"xsjuu4i","ref":"@js.script","value":"\nreturn _lib.THREE && canvas;"},"eyftv46":{"id":"eyftv46","ref":"arg","value":"canvas"},"x4zdk2w":{"id":"x4zdk2w","ref":"@js.script","value":"const renderer = new _lib.THREE.WebGLRenderer({canvas});\nconsole.log(\"creating renderer\", renderer)\nreturn renderer"},"cwl59lh":{"id":"cwl59lh","name":"","ref":"arg","value":"canvas"}},"out":"main/out"},{"edges":{"5eegbyt":{"as":"lib","from":"5eegbyt","to":"main/out"},"mau19q3":{"as":"value","from":"mau19q3","to":"main/out"},"x4zdk2w":{"as":"value","from":"x4zdk2w","to":"mau19q3"},"glh8wzi":{"as":"THREE","from":"glh8wzi","to":"5eegbyt"},"hqgwi6x":{"as":"value","from":"hqgwi6x","to":"glh8wzi"}},"id":"@three.scene","nodes":{"main/out":{"__isnodysseus":true,"id":"main/out","name":"@three.scene","ref":"return"},"mau19q3":{"id":"mau19q3","ref":"@debug.log","value":"outscene"},"x4zdk2w":{"id":"x4zdk2w","ref":"@js.script","value":"return new _lib.THREE.Scene();"},"5eegbyt":{"id":"5eegbyt"},"glh8wzi":{"id":"glh8wzi","ref":"@memory.cache"},"hqgwi6x":{"id":"hqgwi6x","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/npm/three/build/three.module.js"}},"out":"main/out"},{"description":"A three.js [PerspectiveCamera](https://threejs.org/docs/?q=camera#api/en/cameras/PerspectiveCamera)","edges":{"args":{"as":"args","from":"args","to":"main/out"},"on0gkah":{"as":"lib","from":"on0gkah","to":"main/out"},"x4zdk2w":{"as":"value","from":"x4zdk2w","to":"main/out"},"11u8kd6":{"as":"height","from":"11u8kd6","to":"x4zdk2w"},"qvf3y0y":{"as":"width","from":"qvf3y0y","to":"x4zdk2w"},"dln8uxf":{"as":"THREE","from":"dln8uxf","to":"on0gkah"},"h1x8bxs":{"as":"value","from":"h1x8bxs","to":"dln8uxf"},"n79e1ca":{"as":"THREE","from":"n79e1ca","to":"args"},"vjfgmrl":{"as":"value","from":"vjfgmrl","to":"n79e1ca"}},"id":"@three.camera","nodes":{"main/out":{"__isnodysseus":true,"id":"main/out","name":"@three.camera","ref":"return"},"x4zdk2w":{"id":"x4zdk2w","ref":"@js.script","value":"return new _lib.THREE.PerspectiveCamera( 75, width / height, 0.1, 1000 );"},"qvf3y0y":{"id":"qvf3y0y","ref":"arg","value":"canvas.width"},"11u8kd6":{"id":"11u8kd6","ref":"arg","value":"canvas.height"},"on0gkah":{"id":"on0gkah","ref":"extern","value":"extern.data"},"dln8uxf":{"id":"dln8uxf","ref":"@memory.cache"},"h1x8bxs":{"id":"h1x8bxs","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/npm/three/build/three.module.js"},"args":{"id":"args","ref":"extern","value":"extern.data"},"n79e1ca":{"id":"n79e1ca","ref":"@memory.cache"},"vjfgmrl":{"id":"vjfgmrl","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/npm/three/build/three.module.js"}},"out":"main/out"},{"description":"Creates a basic three.js scene with a camera, renderer, and scene. The `objects` input has the objects of the scene, evaluated every frame - make sure to cache. The `onupdate` input is a runnable with parameters `objects`, `camera`, and `scene` which is run every frame - keep. The `fx` input has effects for an EffectComposer.","edges":{"8m5muxn/39ivise":{"as":"args","from":"8m5muxn/39ivise","to":"8m5muxn/8m5muxn"},"8m5muxn/njzfcz8":{"as":"value","from":"8m5muxn/njzfcz8","to":"8m5muxn/8m5muxn"},"qioaglu":{"as":"lib","from":"qioaglu","to":"8m5muxn/8m5muxn"},"yg3wpau":{"as":"metadata","from":"yg3wpau","to":"8m5muxn/8m5muxn"},"0hdpvrw":{"as":"parameters","from":"0hdpvrw","to":"yg3wpau"},"t3nkm46":{"as":"onupdate","from":"t3nkm46","to":"0hdpvrw"},"y7wb70a":{"as":"runnableParameters","from":"y7wb70a","to":"t3nkm46"},"yb47doj":{"as":"type","from":"yb47doj","to":"t3nkm46"},"kipwn58":{"as":"EffectComposer","from":"kipwn58","to":"qioaglu"},"vl4foaa":{"as":"RenderPass","from":"vl4foaa","to":"qioaglu"},"yt5ewda":{"as":"nodeFrame","from":"yt5ewda","to":"qioaglu"},"dt9q1m5":{"as":"value","from":"dt9q1m5","to":"yt5ewda"},"bqpkucx":{"as":"target","from":"bqpkucx","to":"dt9q1m5"},"7peak26":{"as":"value","from":"7peak26","to":"vl4foaa"},"slle0cq":{"as":"target","from":"slle0cq","to":"7peak26"},"4a9zo9a":{"as":"value","from":"4a9zo9a","to":"kipwn58"},"i39y0i3":{"as":"target","from":"i39y0i3","to":"4a9zo9a"},"8m5muxn/hlqmo48":{"as":"args","from":"8m5muxn/hlqmo48","to":"8m5muxn/njzfcz8"},"8m5muxn/vyr07ts":{"as":"subscribe","from":"8m5muxn/vyr07ts","to":"8m5muxn/njzfcz8"},"jiobf52":{"as":"value","from":"jiobf52","to":"8m5muxn/njzfcz8"},"bolfyb6":{"as":"renderer","from":"bolfyb6","to":"jiobf52"},"vbytevd":{"as":"objects","from":"vbytevd","to":"jiobf52"},"5izf471":{"as":"arg0","from":"5izf471","to":"vbytevd"},"93zbauo":{"as":"arg1","from":"93zbauo","to":"vbytevd"},"jlt4j7w":{"as":"true","from":"jlt4j7w","to":"5izf471"},"vtg79yy":{"as":"pred","from":"vtg79yy","to":"5izf471"},"3azmpq8":{"as":"children","from":"3azmpq8","to":"jlt4j7w"},"gsjsnq6":{"as":"parent","from":"gsjsnq6","to":"jlt4j7w"},"4b08vk7":{"as":"fn","from":"4b08vk7","to":"3azmpq8"},"68gerc9":{"as":"array","from":"68gerc9","to":"3azmpq8"},"b10ohnk":{"as":"false","from":"b10ohnk","to":"68gerc9"},"nxy186l":{"as":"pred","from":"nxy186l","to":"68gerc9"},"vbr6bfa":{"as":"true","from":"vbr6bfa","to":"68gerc9"},"cuqczbo":{"as":"pred","from":"cuqczbo","to":"vbr6bfa"},"cvvim9o":{"as":"true","from":"cvvim9o","to":"vbr6bfa"},"r7h1ra6":{"as":"false","from":"r7h1ra6","to":"vbr6bfa"},"simk3kf":{"as":"entries","from":"simk3kf","to":"r7h1ra6"},"pem42eq":{"as":"object","from":"pem42eq","to":"simk3kf"},"fsculei":{"as":"otherwise","from":"fsculei","to":"pem42eq"},"v3dcfpc":{"as":"value","from":"v3dcfpc","to":"pem42eq"},"1iad2e6":{"as":"obj","from":"1iad2e6","to":"cvvim9o"},"1gxmhg0":{"as":"objs","from":"1gxmhg0","to":"cuqczbo"},"60subyt":{"as":"parameters","from":"60subyt","to":"4b08vk7"},"pv3ip30":{"as":"fn","from":"pv3ip30","to":"4b08vk7"},"dipv2w0":{"as":"value","from":"dipv2w0","to":"pv3ip30"},"ibgd3fg":{"as":"target","from":"ibgd3fg","to":"pv3ip30"},"z7toomi":{"as":"target","from":"z7toomi","to":"ibgd3fg"},"4j1cb5p":{"as":"target","from":"4j1cb5p","to":"dipv2w0"},"xxcz1u7":{"as":"element","from":"xxcz1u7","to":"60subyt"},"slwyovm":{"as":"reference","from":"slwyovm","to":"bolfyb6"},"ptak9t2":{"as":"animationframe","from":"ptak9t2","to":"8m5muxn/vyr07ts"},"c6eig78":{"as":"fn","from":"c6eig78","to":"ptak9t2"},"7c7zppx":{"as":"arg2","from":"7c7zppx","to":"c6eig78"},"rmqxb31":{"as":"arg4","from":"rmqxb31","to":"c6eig78"},"z552097":{"as":"arg5","from":"z552097","to":"c6eig78"},"dyst9ju":{"as":"fn","from":"dyst9ju","to":"z552097"},"1js087x":{"as":"camera","from":"1js087x","to":"dyst9ju"},"cha35wd":{"as":"scene","from":"cha35wd","to":"dyst9ju"},"cvop6x9":{"as":"renderer","from":"cvop6x9","to":"dyst9ju"},"3jbd385":{"as":"value","from":"3jbd385","to":"cvop6x9"},"e9d6mmx":{"as":"otherwise","from":"e9d6mmx","to":"cvop6x9"},"0wp18c9":{"as":"args","from":"0wp18c9","to":"e9d6mmx"},"cwrlosg":{"as":"run","from":"cwrlosg","to":"e9d6mmx"},"jjmvxjj":{"as":"fn","from":"jjmvxjj","to":"e9d6mmx"},"lugpx4o":{"as":"value","from":"lugpx4o","to":"0wp18c9"},"6s18wo7":{"as":"camera","from":"6s18wo7","to":"lugpx4o"},"eamyj81":{"as":"scene","from":"eamyj81","to":"lugpx4o"},"hsytqp3":{"as":"renderer","from":"hsytqp3","to":"lugpx4o"},"svcshll":{"as":"canvas","from":"svcshll","to":"lugpx4o"},"vwa13pj":{"as":"fx","from":"vwa13pj","to":"lugpx4o"},"vzmvbqh":{"as":"MotionBlur","from":"vzmvbqh","to":"lugpx4o"},"23ppkmp":{"as":"pred","from":"23ppkmp","to":"vzmvbqh"},"3876w2f":{"as":"true","from":"3876w2f","to":"vzmvbqh"},"ya36a1r":{"as":"module","from":"ya36a1r","to":"3876w2f"},"fzf3k5e":{"as":"RenderPass","from":"fzf3k5e","to":"vwa13pj"},"gap7au7":{"as":"EffectComposer","from":"gap7au7","to":"vwa13pj"},"1j95u16":{"as":"canvas","from":"1j95u16","to":"hsytqp3"},"zs7iowa":{"as":"reference","from":"zs7iowa","to":"3jbd385"},"b2z2580":{"as":"true","from":"b2z2580","to":"rmqxb31"},"mh5ikoc":{"as":"pred","from":"mh5ikoc","to":"rmqxb31"},"m291v0o":{"as":"args","from":"m291v0o","to":"b2z2580"},"wcnk2sw":{"as":"fn","from":"wcnk2sw","to":"b2z2580"},"2veqlq1":{"as":"scene","from":"2veqlq1","to":"m291v0o"},"y2f8gog":{"as":"camera","from":"y2f8gog","to":"m291v0o"},"aqfc51v":{"as":"fn","from":"aqfc51v","to":"7c7zppx"},"5m99dxg":{"as":"true","from":"5m99dxg","to":"aqfc51v"},"x638fhv":{"as":"pred","from":"x638fhv","to":"aqfc51v"},"tfl58nu":{"as":"arg0","from":"tfl58nu","to":"x638fhv"},"xmd2fqb":{"as":"arg1","from":"xmd2fqb","to":"x638fhv"},"xel6go6":{"as":"reference","from":"xel6go6","to":"tfl58nu"},"fznso76":{"as":"fx","from":"fznso76","to":"5m99dxg"},"t181hfh":{"as":"renderer","from":"t181hfh","to":"5m99dxg"},"4fxcgml":{"as":"reference","from":"4fxcgml","to":"t181hfh"},"8m5muxn/7in78pu":{"as":"_camera","from":"8m5muxn/7in78pu","to":"8m5muxn/hlqmo48"},"8m5muxn/inq87j9":{"as":"_scene","from":"8m5muxn/inq87j9","to":"8m5muxn/hlqmo48"},"8m5muxn/gwavfrm":{"as":"value","from":"8m5muxn/gwavfrm","to":"8m5muxn/inq87j9"},"8m5muxn/33kmaec":{"as":"target","from":"8m5muxn/33kmaec","to":"8m5muxn/7in78pu"},"8m5muxn/v1nqvl7":{"as":"value","from":"8m5muxn/v1nqvl7","to":"8m5muxn/7in78pu"},"8m5muxn/zci8apj":{"as":"value","from":"8m5muxn/zci8apj","to":"8m5muxn/33kmaec"},"t8adnxm":{"as":"canvas","from":"t8adnxm","to":"8m5muxn/zci8apj"},"40aw44l":{"as":"_renderer","from":"40aw44l","to":"8m5muxn/39ivise"}},"id":"@three.setup","name":"three.setup","nodes":{"8m5muxn/8m5muxn":{"id":"8m5muxn/8m5muxn","name":"@three.setup","ref":"return"},"yg3wpau":{"id":"yg3wpau"},"0hdpvrw":{"id":"0hdpvrw"},"t3nkm46":{"id":"t3nkm46"},"yb47doj":{"id":"yb47doj","value":"@flow.runnable"},"y7wb70a":{"id":"y7wb70a","ref":"@data.array","value":"objects, camera"},"qioaglu":{"id":"qioaglu"},"yt5ewda":{"id":"yt5ewda","ref":"@memory.cache"},"dt9q1m5":{"id":"dt9q1m5","ref":"@data.get","value":"nodeFrame"},"bqpkucx":{"id":"bqpkucx","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/npm/three/examples/jsm/renderers/webgl-legacy/nodes/WebGLNodes.js"},"vl4foaa":{"id":"vl4foaa","ref":"@memory.cache"},"7peak26":{"id":"7peak26","ref":"@data.get","value":"RenderPass"},"slle0cq":{"id":"slle0cq","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/npm/three/examples/jsm/postprocessing/RenderPass.js"},"kipwn58":{"id":"kipwn58","ref":"@memory.cache"},"4a9zo9a":{"id":"4a9zo9a","ref":"@data.get","value":"EffectComposer"},"i39y0i3":{"id":"i39y0i3","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/npm/three/examples/jsm/postprocessing/EffectComposer.js"},"8m5muxn/njzfcz8":{"id":"8m5muxn/njzfcz8","name":"","ref":"return"},"jiobf52":{"id":"jiobf52"},"vbytevd":{"id":"vbytevd","ref":"@js.script","value":"return arg0;"},"93zbauo":{"id":"93zbauo","ref":"arg","value":"objects"},"5izf471":{"id":"5izf471","ref":"@flow.if"},"vtg79yy":{"id":"vtg79yy","ref":"arg","value":"_scene"},"jlt4j7w":{"id":"jlt4j7w","ref":"@three.update_children"},"gsjsnq6":{"id":"gsjsnq6","ref":"arg","value":"_scene"},"3azmpq8":{"id":"3azmpq8","ref":"@data.map"},"68gerc9":{"id":"68gerc9","ref":"@flow.if"},"vbr6bfa":{"id":"vbr6bfa","ref":"@flow.if"},"r7h1ra6":{"id":"r7h1ra6","ref":"@js.script","value":"return entries.flatMap(e => e?.[1] && Array.isArray(e[1]) ? e[1].map((c, i) => [e[0] + i, c]) : [e]).filter(e => e[1]);"},"simk3kf":{"id":"simk3kf","ref":"@data.object_entries"},"pem42eq":{"id":"pem42eq","ref":"@flow.default"},"v3dcfpc":{"id":"v3dcfpc","ref":"arg","value":"objects"},"fsculei":{"id":"fsculei","value":"{}"},"cvvim9o":{"id":"cvvim9o","ref":"@js.script","value":"// compensate for automatic passthrough\nreturn [[\"arg0\", obj]]"},"1iad2e6":{"id":"1iad2e6","ref":"arg","value":"objects"},"cuqczbo":{"id":"cuqczbo","ref":"@js.script","value":"return objs instanceof _lib.THREE.Object3D"},"1gxmhg0":{"id":"1gxmhg0","ref":"arg","value":"objects"},"nxy186l":{"id":"nxy186l","ref":"arg","value":"objects"},"b10ohnk":{"id":"b10ohnk","ref":"@data.array"},"4b08vk7":{"id":"4b08vk7","ref":"@flow.runnable"},"pv3ip30":{"id":"pv3ip30","ref":"@data.set_mutable","value":"name"},"ibgd3fg":{"id":"ibgd3fg","ref":"@data.get","value":"1"},"z7toomi":{"id":"z7toomi","ref":"arg","value":"element"},"dipv2w0":{"id":"dipv2w0","ref":"@data.get","value":"0"},"4j1cb5p":{"id":"4j1cb5p","ref":"arg","value":"element"},"60subyt":{"id":"60subyt"},"xxcz1u7":{"id":"xxcz1u7"},"bolfyb6":{"id":"bolfyb6","ref":"@memory.readReference"},"slwyovm":{"id":"slwyovm","ref":"arg","value":"_renderer"},"8m5muxn/vyr07ts":{"id":"8m5muxn/vyr07ts","name":""},"ptak9t2":{"id":"ptak9t2","name":"","ref":"@flow.ap"},"c6eig78":{"id":"c6eig78","ref":"@data.array"},"z552097":{"id":"z552097","ref":"@flow.runnable"},"dyst9ju":{"id":"dyst9ju","ref":"@js.script","value":"if(renderer) {\n  //renderer.render(scene, camera);\n  _lib.nodeFrame.update();\n  renderer.render();\n}"},"cvop6x9":{"id":"cvop6x9","ref":"@flow.default"},"e9d6mmx":{"id":"e9d6mmx","ref":"@flow.ap"},"jjmvxjj":{"id":"jjmvxjj","ref":"arg","value":"_renderer.set"},"cwrlosg":{"id":"cwrlosg","value":"true"},"0wp18c9":{"id":"0wp18c9"},"lugpx4o":{"id":"lugpx4o","ref":"@js.script","value":"if(!renderer){\n  return;\n}\nconst fxcomposer = new fx.EffectComposer(renderer)\nconst renderpass = new fx.RenderPass(scene, camera);\nfxcomposer.setSize(canvas.width, canvas.height);\nfxcomposer.addPass(renderpass);\nif(MotionBlur) {\n  const pass = new MotionBlur(scene, camera, { samples: 32, expandgeometry: 0.4 });\n  fxcomposer.addPass(pass);\n  pass.renderToScreen = true;\n}\nreturn fxcomposer;"},"vzmvbqh":{"id":"vzmvbqh","ref":"@flow.if"},"3876w2f":{"id":"3876w2f","ref":"@js.script","value":"return module.MotionBlurPass;"},"ya36a1r":{"id":"ya36a1r","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/gh/ulyssesdotcodes/threejs-sandbox@94c68f4/motionBlurPass/src/MotionBlurPass.js"},"23ppkmp":{"id":"23ppkmp","ref":"arg","value":"motionBlur"},"vwa13pj":{"id":"vwa13pj"},"gap7au7":{"id":"gap7au7","ref":"arg","value":"_lib.EffectComposer"},"fzf3k5e":{"id":"fzf3k5e","ref":"arg","value":"_lib.RenderPass"},"svcshll":{"id":"svcshll","ref":"arg","value":"canvas"},"hsytqp3":{"id":"hsytqp3","name":"","ref":"@three.renderer"},"1j95u16":{"id":"1j95u16","ref":"arg","value":"canvas"},"eamyj81":{"id":"eamyj81","ref":"arg","value":"_scene: internal"},"6s18wo7":{"id":"6s18wo7","ref":"arg","value":"_camera: internal"},"3jbd385":{"id":"3jbd385","ref":"@memory.readReference"},"zs7iowa":{"id":"zs7iowa","ref":"arg","value":"_renderer"},"cha35wd":{"id":"cha35wd","ref":"arg","value":"_scene: internal"},"1js087x":{"id":"1js087x","ref":"arg","value":"_camera: internal"},"rmqxb31":{"id":"rmqxb31","ref":"@flow.if"},"mh5ikoc":{"id":"mh5ikoc","ref":"arg","value":"onupdate"},"b2z2580":{"id":"b2z2580","ref":"@flow.ap"},"wcnk2sw":{"id":"wcnk2sw","ref":"arg","value":"onupdate"},"m291v0o":{"id":"m291v0o"},"y2f8gog":{"id":"y2f8gog","ref":"arg","value":"_camera: internal"},"2veqlq1":{"id":"2veqlq1","ref":"arg","value":"_scene"},"7c7zppx":{"id":"7c7zppx","ref":"@flow.runnable"},"aqfc51v":{"id":"aqfc51v","ref":"@flow.if"},"x638fhv":{"id":"x638fhv","ref":"@js.script","value":"\nreturn arg1 && arg0"},"xmd2fqb":{"id":"xmd2fqb","ref":"arg","value":"fx"},"tfl58nu":{"id":"tfl58nu","ref":"@memory.readReference"},"xel6go6":{"id":"xel6go6","ref":"arg","value":"_renderer"},"5m99dxg":{"id":"5m99dxg","ref":"@js.script","value":"fx?.forEach((pass, idx) => {\n  // +1 for renderpass\n  if(renderer.passes[idx + 1] !== pass) {\n    if(renderer.passes.length > idx + 1) {\n      console.log(\"removing\", idx)  \n      renderer.removePass(renderer.passes[idx + 1]);\n    }\n    console.log(\"adding fx \", pass)\n    renderer.insertPass(pass, idx + 1);\n  }\n});\n\nif(fx && renderer.passes.length > fx?.length + 1) {\n  renderer.passes.splice(fx.length, renderer.passes.length)\n}"},"t181hfh":{"id":"t181hfh","ref":"@memory.readReference"},"4fxcgml":{"id":"4fxcgml","ref":"arg","value":"_renderer"},"fznso76":{"id":"fznso76","ref":"arg","value":"fx"},"8m5muxn/hlqmo48":{"id":"8m5muxn/hlqmo48"},"8m5muxn/inq87j9":{"id":"8m5muxn/inq87j9","name":"","ref":"@memory.cache"},"8m5muxn/gwavfrm":{"__isnodysseus":true,"id":"8m5muxn/gwavfrm","ref":"@three.scene","value":""},"8m5muxn/7in78pu":{"id":"8m5muxn/7in78pu","ref":"@data.set_mutable","value":"position.z"},"8m5muxn/v1nqvl7":{"id":"8m5muxn/v1nqvl7","value":"5"},"8m5muxn/33kmaec":{"id":"8m5muxn/33kmaec","ref":"@memory.cache"},"8m5muxn/zci8apj":{"__isnodysseus":true,"id":"8m5muxn/zci8apj","ref":"@three.camera","value":""},"t8adnxm":{"id":"t8adnxm","ref":"arg","value":"canvas"},"8m5muxn/39ivise":{"id":"8m5muxn/39ivise"},"40aw44l":{"id":"40aw44l","ref":"@memory.reference"}},"out":"8m5muxn/8m5muxn"},{"description":"Import an EffectPass from three.js [postprocessing directory](https://github.com/mrdoob/three.js/tree/master/examples/jsm/postprocessing)","edges":{"hn9xu4k":{"as":"metadata","from":"hn9xu4k","to":"t2wl30j"},"id8jixz":{"as":"value","from":"id8jixz","to":"t2wl30j"},"q4tskdl":{"as":"args","from":"q4tskdl","to":"t2wl30j"},"8vmndbd":{"as":"module","from":"8vmndbd","to":"q4tskdl"},"d4kcr9g":{"as":"_name","from":"d4kcr9g","to":"q4tskdl"},"20oh4kr":{"as":"value","from":"20oh4kr","to":"d4kcr9g"},"ji51v7a":{"as":"otherwise","from":"ji51v7a","to":"d4kcr9g"},"d3iapv9":{"as":"url","from":"d3iapv9","to":"8vmndbd"},"djnnztj":{"as":"name","from":"djnnztj","to":"d3iapv9"},"28v223q":{"as":"otherwise","from":"28v223q","to":"djnnztj"},"keuejig":{"as":"value","from":"keuejig","to":"djnnztj"},"k02afe9":{"as":"args","from":"k02afe9","to":"id8jixz"},"pl0t5mz":{"as":"fnparms","from":"pl0t5mz","to":"id8jixz"},"stp926h":{"as":"Pass","from":"stp926h","to":"id8jixz"},"2tffpiq":{"as":"path","from":"2tffpiq","to":"stp926h"},"vlzb2ya":{"as":"target","from":"vlzb2ya","to":"stp926h"},"vj5gyg7":{"as":"fn","from":"vj5gyg7","to":"pl0t5mz"},"5qwvz2n":{"as":"target","from":"5qwvz2n","to":"vj5gyg7"},"tawj490":{"as":"path","from":"tawj490","to":"vj5gyg7"},"gp1qalc":{"as":"otherwise","from":"gp1qalc","to":"k02afe9"},"ztsrxfz":{"as":"value","from":"ztsrxfz","to":"k02afe9"},"zvjdasq":{"as":"parameters","from":"zvjdasq","to":"hn9xu4k"},"zz4sy5z":{"as":"fnparms","from":"zz4sy5z","to":"zvjdasq"},"dt628e9":{"as":"fn","from":"dt628e9","to":"zz4sy5z"},"ecqutvm":{"as":"target","from":"ecqutvm","to":"dt628e9"},"gbi4r4l":{"as":"path","from":"gbi4r4l","to":"dt628e9"}},"id":"@three.fx_pass","name":"FxPass","nodes":{"t2wl30j":{"id":"t2wl30j","name":"@three.fx_pass","ref":"return"},"q4tskdl":{"id":"q4tskdl"},"d4kcr9g":{"id":"d4kcr9g","ref":"@flow.default"},"ji51v7a":{"id":"ji51v7a","ref":"arg","value":"__graph_value"},"20oh4kr":{"id":"20oh4kr","ref":"arg","value":"name"},"8vmndbd":{"id":"8vmndbd","ref":"@js.import_module"},"d3iapv9":{"id":"d3iapv9","ref":"@js.script","value":"return `https://cdn.jsdelivr.net/gh/ulyssesdotcodes/three.js@worker-compatible-afterimage/examples/jsm/postprocessing/${name}.js`\nreturn `https://cdn.jsdelivr.net/npm/three/examples/jsm/postprocessing/${name}.js`"},"djnnztj":{"id":"djnnztj","ref":"@flow.default"},"keuejig":{"id":"keuejig","ref":"arg","value":"name"},"28v223q":{"id":"28v223q","ref":"arg","value":"__graph_value"},"id8jixz":{"id":"id8jixz","ref":"@js.script","value":"return {constructor: Pass, args, fnparms};"},"stp926h":{"id":"stp926h","ref":"@data.get"},"vlzb2ya":{"id":"vlzb2ya","ref":"arg","value":"module"},"2tffpiq":{"id":"2tffpiq","ref":"arg","value":"_name"},"pl0t5mz":{"id":"pl0t5mz","ref":"extern","value":"extern.functionParameters"},"vj5gyg7":{"id":"vj5gyg7","ref":"@data.get"},"tawj490":{"id":"tawj490","ref":"arg","value":"_name"},"5qwvz2n":{"id":"5qwvz2n","ref":"arg","value":"module"},"k02afe9":{"id":"k02afe9","ref":"@flow.default"},"ztsrxfz":{"id":"ztsrxfz","ref":"arg","value":"args"},"gp1qalc":{"id":"gp1qalc","value":"[]"},"hn9xu4k":{"id":"hn9xu4k"},"zvjdasq":{"id":"zvjdasq","ref":"@js.script","value":"return Object.fromEntries(fnparms.map(p => [p, \"any\"]));"},"zz4sy5z":{"id":"zz4sy5z","ref":"extern","value":"extern.functionParameters"},"dt628e9":{"id":"dt628e9","ref":"@data.get"},"gbi4r4l":{"id":"gbi4r4l","ref":"arg","value":"_name"},"ecqutvm":{"id":"ecqutvm","ref":"arg","value":"module"}},"out":"t2wl30j"},{"description":"Creates a points object with the `geometry` and `material` inputs","edges":{"6mh34xg":{"as":"metadata","from":"6mh34xg","to":"out"},"azms2lq":{"as":"dependencies","from":"azms2lq","to":"out"},"output_val":{"as":"value","from":"output_val","to":"out"},"tarqdum":{"as":"args","from":"tarqdum","to":"out"},"5nudo40":{"as":"true","from":"5nudo40","to":"output_val"},"euzoog2":{"as":"pred","from":"euzoog2","to":"output_val"},"h9a5ot3":{"as":"args","from":"h9a5ot3","to":"5nudo40"},"r9ngnn4":{"as":"arg0","from":"r9ngnn4","to":"h9a5ot3"},"xuoy9bd":{"as":"arg1","from":"xuoy9bd","to":"h9a5ot3"},"fh81etg":{"as":"_geo","from":"fh81etg","to":"azms2lq"},"wezuyts":{"as":"material","from":"wezuyts","to":"azms2lq"},"0pm0fel":{"as":"parameters","from":"0pm0fel","to":"6mh34xg"},"bf9pe5s":{"as":"geometry","from":"bf9pe5s","to":"0pm0fel"},"yp7zxat":{"as":"material","from":"yp7zxat","to":"0pm0fel"}},"id":"@three.points","nodes":{"out":{"id":"out","name":"@three.points","ref":"return"},"tarqdum":{"id":"tarqdum"},"output_val":{"id":"output_val","ref":"@flow.if"},"euzoog2":{"id":"euzoog2","ref":"arg","value":"geometry"},"5nudo40":{"id":"5nudo40","ref":"@js.script","value":"return new _lib.THREE.Points(...args);"},"h9a5ot3":{"id":"h9a5ot3","ref":"@data.array"},"xuoy9bd":{"id":"xuoy9bd","ref":"arg","value":"material"},"r9ngnn4":{"id":"r9ngnn4","ref":"arg","value":"geometry"},"azms2lq":{"id":"azms2lq"},"wezuyts":{"id":"wezuyts","ref":"arg","value":"material"},"fh81etg":{"id":"fh81etg","ref":"arg","value":"geometry"},"6mh34xg":{"id":"6mh34xg"},"0pm0fel":{"id":"0pm0fel"},"yp7zxat":{"id":"yp7zxat","value":"@three.node"},"bf9pe5s":{"id":"bf9pe5s","value":"@three.geometry"}},"out":"out"},{"edges":{"ba4lg0w":{"as":"metadata","from":"ba4lg0w","to":"t2wl30j"},"q4hk4bw":{"as":"value","from":"q4hk4bw","to":"t2wl30j"},"q4tskdl":{"as":"args","from":"q4tskdl","to":"t2wl30j"},"hafko00":{"as":"_threenode","from":"hafko00","to":"q4tskdl"},"o5sgysd":{"as":"_nodes","from":"o5sgysd","to":"q4tskdl"},"m77x5cf":{"as":"url","from":"m77x5cf","to":"o5sgysd"},"6mna45b":{"as":"value","from":"6mna45b","to":"hafko00"},"mm3wm5n":{"as":"dependencies","from":"mm3wm5n","to":"hafko00"},"wkm9i8b":{"as":"args","from":"wkm9i8b","to":"hafko00"},"3gnkfqm":{"as":"_name","from":"3gnkfqm","to":"wkm9i8b"},"ahfnizi":{"as":"target","from":"ahfnizi","to":"mm3wm5n"},"d0a6i85":{"as":"arg0","from":"d0a6i85","to":"mm3wm5n"},"r63ulo9":{"as":"name","from":"r63ulo9","to":"ahfnizi"},"eac03sk":{"as":"true","from":"eac03sk","to":"6mna45b"},"tjn10xk":{"as":"pred","from":"tjn10xk","to":"6mna45b"},"cb8yguh":{"as":"value","from":"cb8yguh","to":"eac03sk"},"e4rdngl":{"as":"args","from":"e4rdngl","to":"eac03sk"},"4skly0x":{"as":"_nodeinstance","from":"4skly0x","to":"e4rdngl"},"cxmm7kf":{"as":"nodeArgs","from":"cxmm7kf","to":"4skly0x"},"ey5xe1p":{"as":"nodes","from":"ey5xe1p","to":"4skly0x"},"f1wqp7p":{"as":"args","from":"f1wqp7p","to":"4skly0x"},"qc5yhrk":{"as":"Node","from":"qc5yhrk","to":"4skly0x"},"t90v2ws":{"as":"returnFn","from":"t90v2ws","to":"4skly0x"},"tj0ue40":{"as":"name","from":"tj0ue40","to":"4skly0x"},"xntibr1":{"as":"fnparms","from":"xntibr1","to":"4skly0x"},"l31buvo":{"as":"fn","from":"l31buvo","to":"xntibr1"},"asa6egn":{"as":"path","from":"asa6egn","to":"l31buvo"},"m4euspc":{"as":"target","from":"m4euspc","to":"l31buvo"},"zg12st9":{"as":"url","from":"zg12st9","to":"m4euspc"},"6dpj05t":{"as":"path","from":"6dpj05t","to":"qc5yhrk"},"fzpv502":{"as":"target","from":"fzpv502","to":"qc5yhrk"},"20zj22n":{"as":"url","from":"20zj22n","to":"fzpv502"},"1vdqyt6":{"as":"value","from":"1vdqyt6","to":"f1wqp7p"},"wm6hu13":{"as":"otherwise","from":"wm6hu13","to":"f1wqp7p"},"qbshzkl":{"as":"url","from":"qbshzkl","to":"ey5xe1p"},"g2ai982":{"as":"arg0","from":"g2ai982","to":"cxmm7kf"},"g7jjpiy":{"as":"target","from":"g7jjpiy","to":"cxmm7kf"},"68j6hjq":{"as":"true","from":"68j6hjq","to":"cb8yguh"},"txmw3pd":{"as":"pred","from":"txmw3pd","to":"cb8yguh"},"an8n9z9":{"as":"arg0","from":"an8n9z9","to":"68j6hjq"},"homn2x7":{"as":"target","from":"homn2x7","to":"68j6hjq"},"okhx7t6":{"as":"fnparms","from":"okhx7t6","to":"an8n9z9"},"xsnh3pb":{"as":"baseargs","from":"xsnh3pb","to":"an8n9z9"},"uobnyvk":{"as":"fn","from":"uobnyvk","to":"okhx7t6"},"m4yoq67":{"as":"target","from":"m4yoq67","to":"uobnyvk"},"pw73t77":{"as":"path","from":"pw73t77","to":"uobnyvk"},"t9olptl":{"as":"url","from":"t9olptl","to":"m4yoq67"},"r1c4ero":{"as":"value","from":"r1c4ero","to":"ba4lg0w"},"0e52p8o":{"as":"values","from":"0e52p8o","to":"r1c4ero"},"1twurrd":{"as":"parameters","from":"1twurrd","to":"r1c4ero"},"gj47dqe":{"as":"false","from":"gj47dqe","to":"1twurrd"},"ra5i4nx":{"as":"true","from":"ra5i4nx","to":"1twurrd"},"vu259vf":{"as":"pred","from":"vu259vf","to":"1twurrd"},"cib8xiy":{"as":"path","from":"cib8xiy","to":"vu259vf"},"e1fmps2":{"as":"nodes","from":"e1fmps2","to":"vu259vf"},"3rdanfa":{"as":"node","from":"3rdanfa","to":"ra5i4nx"},"4rmlryt":{"as":"fnparms","from":"4rmlryt","to":"ra5i4nx"},"g8i9gix":{"as":"name","from":"g8i9gix","to":"ra5i4nx"},"qdvndwx":{"as":"nodes","from":"qdvndwx","to":"ra5i4nx"},"595ceg1":{"as":"fn","from":"595ceg1","to":"4rmlryt"},"60htowa":{"as":"path","from":"60htowa","to":"595ceg1"},"tc71fq0":{"as":"target","from":"tc71fq0","to":"595ceg1"},"mbjab0h":{"as":"nodes","from":"mbjab0h","to":"0e52p8o"}},"id":"@three.node","name":"@three.node","nodes":{"t2wl30j":{"id":"t2wl30j","name":"@three.node","ref":"return"},"q4tskdl":{"id":"q4tskdl"},"o5sgysd":{"hafko00":"8f5duig","id":"o5sgysd","ref":"@js.import_module"},"m77x5cf":{"id":"m77x5cf","ref":"@js.script","value":"\nreturn `https://cdn.jsdelivr.net/npm/three/examples/jsm/nodes/Nodes.js`"},"hafko00":{"id":"hafko00","ref":"return"},"wkm9i8b":{"id":"wkm9i8b"},"3gnkfqm":{"id":"3gnkfqm","ref":"arg","value":"__graph_value"},"mm3wm5n":{"id":"mm3wm5n","ref":"@data.merge_objects"},"d0a6i85":{"id":"d0a6i85","ref":"arg","value":"_argsdata"},"ahfnizi":{"id":"ahfnizi"},"r63ulo9":{"id":"r63ulo9","ref":"arg","value":"_name"},"6mna45b":{"id":"6mna45b","ref":"@flow.if"},"tjn10xk":{"id":"tjn10xk","ref":"arg","value":"_name"},"eac03sk":{"id":"eac03sk","ref":"return"},"e4rdngl":{"id":"e4rdngl"},"4skly0x":{"id":"4skly0x","ref":"@js.script","value":"if(returnFn) return Node;\n\nlet created;\n\nconst isConst = Node.toString() == nodes.float.toString();\nif(isConst) {\n  const parms = nodeArgs[\"value\"] ?? args;\n  console.log(\"top return\", Node, parms)\n  return Node(...(Array.isArray(parms) ? parms : [parms]));\n}\nconst argArr = [];\nfnparms?.forEach(p => p !== 'params' && p !== 'parameters' && argArr.push(nodeArgs[p]));\n(Array.isArray(args) ? args : [args]).forEach(v => argArr.push(v));\n\ntry {\n  created = new Node(...argArr)\n}catch(e){\n  created = typeof Node === \"function\" ?  Node(...argArr) : Node;\n}\n\nconsole.log(\"bottom return\", created);\n\n//created.update && created.update();\n\nreturn created"},"xntibr1":{"id":"xntibr1","ref":"extern","value":"extern.functionParameters"},"l31buvo":{"id":"l31buvo","ref":"@data.get"},"m4euspc":{"hafko00":"8f5duig","id":"m4euspc","ref":"@js.import_module"},"zg12st9":{"id":"zg12st9","ref":"@js.script","value":"\nreturn `https://cdn.jsdelivr.net/npm/three/examples/jsm/nodes/Nodes.js`"},"asa6egn":{"id":"asa6egn","ref":"arg","value":"_name"},"tj0ue40":{"id":"tj0ue40","ref":"arg","value":"__graph_value"},"t90v2ws":{"id":"t90v2ws","ref":"arg","value":"returnFn"},"qc5yhrk":{"id":"qc5yhrk","ref":"@data.get"},"fzpv502":{"hafko00":"8f5duig","id":"fzpv502","ref":"@js.import_module"},"20zj22n":{"id":"20zj22n","ref":"@js.script","value":"\nreturn `https://cdn.jsdelivr.net/npm/three/examples/jsm/nodes/Nodes.js`"},"6dpj05t":{"id":"6dpj05t","ref":"arg","value":"_name"},"f1wqp7p":{"id":"f1wqp7p","ref":"@flow.default"},"wm6hu13":{"id":"wm6hu13","value":"[]"},"1vdqyt6":{"id":"1vdqyt6","ref":"arg","value":"args"},"ey5xe1p":{"hafko00":"8f5duig","id":"ey5xe1p","ref":"@js.import_module"},"qbshzkl":{"id":"qbshzkl","ref":"@js.script","value":"\nreturn `https://cdn.jsdelivr.net/npm/three/examples/jsm/nodes/Nodes.js`"},"cxmm7kf":{"id":"cxmm7kf","ref":"@data.merge_objects_mutable"},"g7jjpiy":{"id":"g7jjpiy","value":"{}"},"g2ai982":{"id":"g2ai982","ref":"arg","value":"_argsdata"},"cb8yguh":{"id":"cb8yguh","ref":"@flow.if"},"txmw3pd":{"id":"txmw3pd","ref":"arg","value":"_nodeinstance"},"68j6hjq":{"id":"68j6hjq","ref":"@data.merge_objects_mutable"},"homn2x7":{"id":"homn2x7","ref":"arg","value":"_nodeinstance"},"an8n9z9":{"id":"an8n9z9","ref":"@js.script","value":"console.log(\"baseargs\", baseargs);\nconst args = Object.fromEntries(\n  Object.entries(baseargs).filter(kv => \n  kv[1] !== undefined &&\n  kv[0] !== \"args\" &&\n  !kv[0].startsWith(\"_\") &&\n  !fnparms.includes(kv[0]) ));\n/*\nfor(let parm of fnparms) {\n  delete args[parm]\n}\ndelete args[\"args\"];\ndelete args[\"_nodeinstance\"]\nfor(let kv of args) {\n  if(kv[1] === undefined) delete args[kv[0]]\n}\n*/\nreturn args;"},"xsnh3pb":{"id":"xsnh3pb","ref":"arg","value":"_argsdata"},"okhx7t6":{"id":"okhx7t6","ref":"extern","value":"extern.functionParameters"},"uobnyvk":{"id":"uobnyvk","ref":"@data.get"},"pw73t77":{"id":"pw73t77","ref":"arg","value":"_name"},"m4yoq67":{"hafko00":"8f5duig","id":"m4yoq67","ref":"@js.import_module"},"t9olptl":{"id":"t9olptl","ref":"@js.script","value":"\nreturn `https://cdn.jsdelivr.net/npm/three/examples/jsm/nodes/Nodes.js`"},"q4hk4bw":{"id":"q4hk4bw","ref":"arg","value":"_threenode"},"ba4lg0w":{"id":"ba4lg0w","ref":"@debug.log","value":"node metadata"},"r1c4ero":{"id":"r1c4ero"},"1twurrd":{"id":"1twurrd","ref":"@flow.if"},"vu259vf":{"id":"vu259vf","ref":"@js.script","value":"return path && nodes && nodes[path];"},"e1fmps2":{"id":"e1fmps2","ref":"arg","value":"_nodes"},"cib8xiy":{"id":"cib8xiy","ref":"arg","value":"__graph_value"},"ra5i4nx":{"id":"ra5i4nx","ref":"@js.script","value":"const nodeKeys = node && Array.from(Object.keys(node)).filter(k => !k.startsWith(\"_\") && !k.startsWith(\"is\") && k.endsWith(\"Node\"));\nconst parms =  Object.fromEntries(nodeKeys.map(k => [k, {type: \"@three.node\"}])\n                                  .concat(fnparms?.filter(p => p !== 'params' && p !== 'parameters').map(p => [p, {type: 'any'}]) ?? [])\n.concat(name && nodes[name].toString() === nodes.float.toString() ? [['value', {type: 'any'}]] : [] ));\n\nreturn parms;"},"qdvndwx":{"id":"qdvndwx","ref":"arg","value":"_nodes"},"g8i9gix":{"id":"g8i9gix","ref":"arg","value":"__graph_value"},"4rmlryt":{"id":"4rmlryt","ref":"extern","value":"extern.functionParameters"},"595ceg1":{"id":"595ceg1","ref":"@data.get"},"tc71fq0":{"id":"tc71fq0","ref":"arg","value":"_nodes"},"60htowa":{"id":"60htowa","ref":"arg","value":"__graph_value"},"3rdanfa":{"id":"3rdanfa","ref":"arg","value":"_threenode"},"gj47dqe":{"id":"gj47dqe","value":"[]"},"0e52p8o":{"id":"0e52p8o","ref":"@js.script","value":"return Object.keys(nodes);"},"mbjab0h":{"id":"mbjab0h","ref":"arg","value":"_nodes"}},"out":"t2wl30j"},{"description":"Applies an instantaneous force vector attribute to the velocity attribute. Then updates position based on velocity.","edges":{"5e0bf11":{"as":"args","from":"5e0bf11","to":"glfw0eh"},"sbvh6lz":{"as":"display","from":"sbvh6lz","to":"glfw0eh"},"vkhfnnr":{"as":"value","from":"vkhfnnr","to":"glfw0eh"},"eml4hhq":{"as":"false","from":"eml4hhq","to":"vkhfnnr"},"wxtf2fm":{"as":"pred","from":"wxtf2fm","to":"vkhfnnr"},"rw70t8y":{"as":"geo","from":"rw70t8y","to":"wxtf2fm"},"4extjs8":{"as":"props","from":"4extjs8","to":"sbvh6lz"},"qqosk8y":{"as":"children","from":"qqosk8y","to":"sbvh6lz"},"58bh5c0":{"as":"onpointerup","from":"58bh5c0","to":"4extjs8"},"gktb1wh":{"as":"onpointerdown","from":"gktb1wh","to":"4extjs8"},"e20k3gp":{"as":"fn","from":"e20k3gp","to":"gktb1wh"},"uy2lf6r":{"as":"args","from":"uy2lf6r","to":"gktb1wh"},"pc0o532":{"as":"value","from":"pc0o532","to":"uy2lf6r"},"srnm0s1":{"as":"fn","from":"srnm0s1","to":"58bh5c0"},"wli26lm":{"as":"args","from":"wli26lm","to":"58bh5c0"},"yjgf8l3":{"as":"value","from":"yjgf8l3","to":"wli26lm"},"9ibt0ds":{"as":"_position","from":"9ibt0ds","to":"5e0bf11"},"aqt67la":{"as":"_reset","from":"aqt67la","to":"5e0bf11"},"szm37b8":{"as":"publish","from":"szm37b8","to":"aqt67la"}},"id":"@three.applyForce","name":"@three.applyForce","nodes":{"glfw0eh":{"id":"glfw0eh","name":"@three.applyForce","ref":"return"},"vkhfnnr":{"id":"vkhfnnr","ref":"@flow.if"},"wxtf2fm":{"id":"wxtf2fm","ref":"@js.script","value":"return !!geo"},"rw70t8y":{"id":"rw70t8y","ref":"arg","value":"geo"},"eml4hhq":{"id":"eml4hhq","ref":"arg","value":"geo"},"sbvh6lz":{"id":"sbvh6lz","ref":"@html.html_element","value":"button"},"qqosk8y":{"id":"qqosk8y","value":"reset"},"4extjs8":{"id":"4extjs8"},"gktb1wh":{"id":"gktb1wh","ref":"@flow.ap"},"uy2lf6r":{"id":"uy2lf6r"},"pc0o532":{"id":"pc0o532","value":"true"},"e20k3gp":{"id":"e20k3gp","ref":"arg","value":"_reset.set"},"58bh5c0":{"id":"58bh5c0","ref":"@flow.ap"},"wli26lm":{"id":"wli26lm"},"yjgf8l3":{"id":"yjgf8l3","value":"false"},"srnm0s1":{"id":"srnm0s1","ref":"arg","value":"_reset.set"},"5e0bf11":{"id":"5e0bf11"},"aqt67la":{"id":"aqt67la","ref":"@memory.state"},"szm37b8":{"id":"szm37b8","value":"true"},"9ibt0ds":{"id":"9ibt0ds","ref":"@memory.reference"}},"out":"glfw0eh"},{"edges":{"3wnevku":{"as":"lib","from":"3wnevku","to":"out"},"j9ryrf2":{"as":"args","from":"j9ryrf2","to":"out"},"k30x2hp":{"as":"value","from":"k30x2hp","to":"out"},"mu0then":{"as":"display","from":"mu0then","to":"out"},"8dy573e":{"as":"resultPanel","from":"8dy573e","to":"mu0then"},"v403c4c":{"as":"background","from":"v403c4c","to":"mu0then"},"i0nsqhm":{"as":"value","from":"i0nsqhm","to":"v403c4c"},"0gek6rd":{"as":"props","from":"0gek6rd","to":"i0nsqhm"},"5od0ko0":{"as":"id","from":"5od0ko0","to":"0gek6rd"},"fiym0hu":{"as":"height","from":"fiym0hu","to":"0gek6rd"},"qj8elo2":{"as":"width","from":"qj8elo2","to":"0gek6rd"},"r4nwedp":{"as":"onref","from":"r4nwedp","to":"0gek6rd"},"wkdxr46":{"as":"style","from":"wkdxr46","to":"0gek6rd"},"4njs1km":{"as":"width","from":"4njs1km","to":"wkdxr46"},"ahh8hb8":{"as":"height","from":"ahh8hb8","to":"wkdxr46"},"22yyw6l":{"as":"fn","from":"22yyw6l","to":"r4nwedp"},"g4798sz":{"as":"args","from":"g4798sz","to":"r4nwedp"},"1wj2f95":{"as":"value","from":"1wj2f95","to":"g4798sz"},"obv7sw5":{"as":"canvas_id","from":"obv7sw5","to":"1wj2f95"},"dvh66tl":{"as":"children","from":"dvh66tl","to":"8dy573e"},"1yuerd9":{"as":"true","from":"1yuerd9","to":"k30x2hp"},"efvhz2z":{"as":"pred","from":"efvhz2z","to":"k30x2hp"},"em7kgrn":{"as":"reference","from":"em7kgrn","to":"efvhz2z"},"h80htub":{"as":"graphid","from":"h80htub","to":"1yuerd9"},"n4gi56l":{"as":"runnable","from":"n4gi56l","to":"1yuerd9"},"yv9n5sm":{"as":"canvas","from":"yv9n5sm","to":"1yuerd9"},"9qyij8r":{"as":"value","from":"9qyij8r","to":"yv9n5sm"},"mjj5l0a":{"as":"reference","from":"mjj5l0a","to":"9qyij8r"},"gsb3j6v":{"as":"graph","from":"gsb3j6v","to":"n4gi56l"},"4kk3eva":{"as":"true","from":"4kk3eva","to":"gsb3j6v"},"zod3llv":{"as":"pred","from":"zod3llv","to":"gsb3j6v"},"zinqm04":{"as":"value","from":"zinqm04","to":"zod3llv"},"32p9r9a":{"as":"objects","from":"32p9r9a","to":"4kk3eva"},"e7zv2pr":{"as":"fx","from":"e7zv2pr","to":"4kk3eva"},"inu16az":{"as":"canvas","from":"inu16az","to":"4kk3eva"},"rvq9lf7":{"as":"value","from":"rvq9lf7","to":"inu16az"},"2k3s5re":{"as":"arg0","from":"2k3s5re","to":"e7zv2pr"},"0cbbw7r":{"as":"value","from":"0cbbw7r","to":"32p9r9a"},"611phdn":{"as":"light","from":"611phdn","to":"32p9r9a"},"ibotc2d":{"as":"value","from":"ibotc2d","to":"611phdn"},"ckj25oo":{"as":"geometry","from":"ckj25oo","to":"0cbbw7r"},"x2cx1bb":{"as":"material","from":"x2cx1bb","to":"0cbbw7r"},"suciusk":{"as":"args","from":"suciusk","to":"x2cx1bb"},"uso7hsl":{"as":"value","from":"uso7hsl","to":"x2cx1bb"},"389d9lz":{"as":"colorNode","from":"389d9lz","to":"uso7hsl"},"tdmtm91":{"as":"sizeNode","from":"tdmtm91","to":"uso7hsl"},"m7dpgz4":{"as":"value","from":"m7dpgz4","to":"389d9lz"},"tuwx0oy":{"as":"noise","from":"tuwx0oy","to":"389d9lz"},"uza84zs":{"as":"cos","from":"uza84zs","to":"389d9lz"},"bvc6i9k":{"as":"aNode","from":"bvc6i9k","to":"uza84zs"},"4r46wno":{"as":"position","from":"4r46wno","to":"tuwx0oy"},"oy08aqj":{"as":"bNode","from":"oy08aqj","to":"4r46wno"},"vm2u9tl":{"as":"aNode","from":"vm2u9tl","to":"4r46wno"},"hkpt1im":{"as":"value","from":"hkpt1im","to":"oy08aqj"},"iplua2j":{"as":"value","from":"iplua2j","to":"m7dpgz4"},"4ko6acf":{"as":"damping","from":"4ko6acf","to":"ckj25oo"},"94ouvnn":{"as":"forcefn","from":"94ouvnn","to":"ckj25oo"},"hxmrzjn":{"as":"geo","from":"hxmrzjn","to":"ckj25oo"},"3flo7bk":{"as":"geo","from":"3flo7bk","to":"hxmrzjn"},"euhzy4e":{"as":"fn","from":"euhzy4e","to":"hxmrzjn"},"0aahmvk":{"as":"value","from":"0aahmvk","to":"94ouvnn"},"vya4vea":{"as":"args","from":"vya4vea","to":"94ouvnn"},"nom74es":{"as":"value","from":"nom74es","to":"vya4vea"},"74ocmdf":{"as":"elementScale","from":"74ocmdf","to":"nom74es"},"7d70qjx":{"as":"curl","from":"7d70qjx","to":"nom74es"},"a5z4avp":{"as":"centreSpeed","from":"a5z4avp","to":"nom74es"},"jt9r6dk":{"as":"loudness","from":"jt9r6dk","to":"nom74es"},"r2htekq":{"as":"time","from":"r2htekq","to":"nom74es"},"r83ilac":{"as":"scale","from":"r83ilac","to":"nom74es"},"a90z9nv":{"as":"target","from":"a90z9nv","to":"r83ilac"},"irpi2by":{"as":"target","from":"irpi2by","to":"a5z4avp"},"owk1ctx":{"as":"target","from":"owk1ctx","to":"74ocmdf"},"47fi22w":{"as":"fn","from":"47fi22w","to":"0aahmvk"},"o4vkdv9":{"as":"parameters","from":"o4vkdv9","to":"0aahmvk"},"8w64pwp":{"as":"point_data","from":"8w64pwp","to":"o4vkdv9"},"4g0kh1x":{"as":"elementScale","from":"4g0kh1x","to":"47fi22w"},"6qk49q0":{"as":"position","from":"6qk49q0","to":"47fi22w"},"ff8ig4w":{"as":"centreSpeed","from":"ff8ig4w","to":"47fi22w"},"fs9otsh":{"as":"time","from":"fs9otsh","to":"47fi22w"},"llf79yf":{"as":"force","from":"llf79yf","to":"47fi22w"},"ow98zzo":{"as":"curl","from":"ow98zzo","to":"47fi22w"},"zpayha9":{"as":"scale","from":"zpayha9","to":"47fi22w"},"k79f57q":{"as":"arg1","from":"k79f57q","to":"zpayha9"},"suov4ge":{"as":"arg0","from":"suov4ge","to":"zpayha9"},"2t1bca9":{"as":"canvas","from":"2t1bca9","to":"j9ryrf2"},"4d0h7cj":{"as":"THREE","from":"4d0h7cj","to":"3wnevku"}},"id":"threejs_example_force_local","nodes":{"out":{"id":"out","name":"threejs_example_force_local","ref":"return"},"mu0then":{"id":"mu0then"},"v403c4c":{"id":"v403c4c","name":"canvas","ref":"return"},"i0nsqhm":{"id":"i0nsqhm","ref":"@html.html_element","value":"canvas"},"0gek6rd":{"id":"0gek6rd"},"wkdxr46":{"id":"wkdxr46"},"ahh8hb8":{"2fn7s1a":"bvvv7l0","id":"ahh8hb8","value":"100vh"},"4njs1km":{"id":"4njs1km","value":"100vw"},"r4nwedp":{"id":"r4nwedp","ref":"@flow.ap"},"g4798sz":{"id":"g4798sz"},"1wj2f95":{"id":"1wj2f95","ref":"@js.script","value":"const canvas = document.getElementById(canvas_id);\nconsole.log(\"got canvas\", canvas)\nreturn canvas.transferControlToOffscreen()"},"obv7sw5":{"id":"obv7sw5","value":"threejsrender"},"22yyw6l":{"id":"22yyw6l","ref":"arg","value":"canvas.set"},"qj8elo2":{"id":"qj8elo2","ref":"@js.script","value":"return window.innerWidth"},"fiym0hu":{"id":"fiym0hu","ref":"@js.script","value":"return window.innerHeight"},"5od0ko0":{"id":"5od0ko0","value":"threejsrender"},"8dy573e":{"id":"8dy573e","ref":"@html.html_element"},"dvh66tl":{"id":"dvh66tl","ref":"@html.html_element"},"k30x2hp":{"id":"k30x2hp","ref":"@flow.if"},"efvhz2z":{"id":"efvhz2z","ref":"@memory.readReference"},"em7kgrn":{"id":"em7kgrn","ref":"arg","value":"canvas"},"1yuerd9":{"id":"1yuerd9","ref":"@three.worker"},"yv9n5sm":{"id":"yv9n5sm","ref":"@debug.log","value":"canvas"},"9qyij8r":{"id":"9qyij8r","ref":"@memory.readReference"},"mjj5l0a":{"id":"mjj5l0a","ref":"arg","value":"canvas"},"n4gi56l":{"id":"n4gi56l","ref":"extern","value":"extern.workerRunnable"},"gsb3j6v":{"id":"gsb3j6v","ref":"@flow.if"},"zod3llv":{"id":"zod3llv","ref":"@debug.log","value":"arg worker canvas"},"zinqm04":{"id":"zinqm04","ref":"arg","value":"canvas"},"4kk3eva":{"id":"4kk3eva","ref":"@three.setup"},"inu16az":{"id":"inu16az","ref":"@debug.log","value":"worker canvas"},"rvq9lf7":{"id":"rvq9lf7","ref":"arg","value":"canvas"},"e7zv2pr":{"id":"e7zv2pr","ref":"@data.array"},"2k3s5re":{"id":"2k3s5re","ref":"@three.fx_pass","value":"UnrealBloomPass"},"32p9r9a":{"id":"32p9r9a"},"611phdn":{"id":"611phdn","ref":"@memory.cache"},"ibotc2d":{"id":"ibotc2d","ref":"@js.script","value":"return new _lib.THREE.HemisphereLight( 0xffffff, 0x080820, 1 );"},"0cbbw7r":{"id":"0cbbw7r","ref":"@three.points"},"x2cx1bb":{"id":"x2cx1bb","ref":"return"},"uso7hsl":{"id":"uso7hsl","ref":"@three.node","value":"PointsNodeMaterial"},"tdmtm91":{"id":"tdmtm91","ref":"@three.node","value":"mx_fractal_noise_float"},"389d9lz":{"id":"389d9lz","ref":"@flow.switchInputs"},"uza84zs":{"id":"uza84zs","ref":"@three.node","value":"cos"},"bvc6i9k":{"id":"bvc6i9k","ref":"@three.node","value":"timerGlobal"},"tuwx0oy":{"id":"tuwx0oy","ref":"@three.node","value":"mx_fractal_noise_vec3"},"4r46wno":{"id":"4r46wno","ref":"@three.node","value":"mul"},"vm2u9tl":{"id":"vm2u9tl","ref":"@three.node","value":"positionWorld"},"oy08aqj":{"id":"oy08aqj","ref":"@three.node","value":"float"},"hkpt1im":{"id":"hkpt1im","value":"0.2"},"m7dpgz4":{"id":"m7dpgz4","ref":"@three.node","value":"float"},"iplua2j":{"id":"iplua2j","value":"1"},"suciusk":{"id":"suciusk"},"ckj25oo":{"id":"ckj25oo","ref":"@three.applyForce"},"hxmrzjn":{"id":"hxmrzjn","ref":"@js.script","value":"return geo;"},"euhzy4e":{"id":"euhzy4e","ref":"extern","value":"extern.frame"},"3flo7bk":{"id":"3flo7bk","ref":"@js.new","value":"THREE.TorusGeometry"},"94ouvnn":{"id":"94ouvnn","ref":"return"},"vya4vea":{"id":"vya4vea","ref":"@debug.log"},"nom74es":{"id":"nom74es"},"r83ilac":{"id":"r83ilac","ref":"@data.get","value":"value"},"a90z9nv":{"id":"a90z9nv","ref":"@html.slider"},"r2htekq":{"id":"r2htekq","ref":"arg","value":"time"},"jt9r6dk":{"id":"jt9r6dk","ref":"arg","value":"loudness"},"a5z4avp":{"id":"a5z4avp","ref":"@data.get","value":"value"},"irpi2by":{"id":"irpi2by","ref":"@html.slider","value":"5"},"7d70qjx":{"id":"7d70qjx","ref":"@math.curlnoise"},"74ocmdf":{"id":"74ocmdf","ref":"@data.get","value":"value"},"owk1ctx":{"id":"owk1ctx","ref":"@html.slider","value":"10"},"0aahmvk":{"id":"0aahmvk","ref":"@flow.runnable"},"o4vkdv9":{"id":"o4vkdv9"},"8w64pwp":{"94ouvnn":"mlixt4e","id":"8w64pwp"},"47fi22w":{"id":"47fi22w","ref":"@js.script","value":"if(isNaN(elementScale) || isNaN(scale) || isNaN(centreSpeed)) {\n  //console.log({centreSpeed, scale, elementScale})\n  return;\n}\nconst v = curl({x: position[0], y: position[1], z: position[2], time: time, elementScale: elementScale}).map(cv => cv * (scale ?? 0.0001));\n\nconst centre = (pos) => Math.abs(pos) > 2 ? Math.abs(pos) * 0.001 * centreSpeed * Math.sign(-pos) : 0;\n\nforce[0] = v[0] + centre(position[0]);\nforce[1] = v[1] + centre(position[1]);\nforce[2] = v[2] + centre(position[2]);"},"zpayha9":{"id":"zpayha9","ref":"@math.mult"},"suov4ge":{"id":"suov4ge","ref":"arg","value":"scale"},"k79f57q":{"id":"k79f57q","value":".01"},"ow98zzo":{"id":"ow98zzo","ref":"arg","value":"curl"},"llf79yf":{"id":"llf79yf","ref":"arg","value":"point_data.force"},"fs9otsh":{"id":"fs9otsh","ref":"@js.script","value":"return performance.now() * 0.001;"},"ff8ig4w":{"id":"ff8ig4w","ref":"arg","value":"centreSpeed"},"6qk49q0":{"id":"6qk49q0","ref":"arg","value":"point_data.position"},"4g0kh1x":{"id":"4g0kh1x","ref":"arg","value":"elementScale"},"4ko6acf":{"id":"4ko6acf","value":".01"},"h80htub":{"id":"h80htub","ref":"arg","value":"__graphid"},"j9ryrf2":{"id":"j9ryrf2"},"2t1bca9":{"id":"2t1bca9","ref":"@memory.reference"},"3wnevku":{"id":"3wnevku"},"4d0h7cj":{"id":"4d0h7cj","ref":"@js.import_module","value":"https://cdn.jsdelivr.net/npm/three/build/three.module.js"}},"out":"out"}]}
